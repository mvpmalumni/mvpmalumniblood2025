
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Mega Blood Donation CAMP 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <header style="background:#c62828; color:white; padding:16px; text-align:center; font-size:20px; font-weight:bold;">
    Mega Blood Donation CAMP 2025<br>
    Organized by MVPM Alumni & MVPM Across Maharashtra
  </header>

  <div id="map" style="height:90vh;"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    let centers = [];

    fetch('centres.json')
      .then(r => r.json())
      .then(data => {
        centers = data;
        initMap();
      });

    function initMap(){
      const map = L.map('map').setView([19.7515,75.7139], 6);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      centers.forEach(c => {
        L.marker([c.lat, c.lng]).addTo(map)
          .bindPopup(
            "<b>" + c.name + "</b><br>" + 
            c.area + ", " + c.city + "<br>" +
            c.time + "<br>Contact: " + c.contact
          );
      });

      map.on('click', function(e){
        let lat = e.latlng.lat;
        let lng = e.latlng.lng;

        let nearest = null;
        let minD = Infinity;

        centers.forEach(c => {
          let d = distance(lat, lng, c.lat, c.lng);
          if(d < minD){
            minD = d;
            nearest = c;
          }
        });

        if(nearest){
          alert(
            "Nearest Centre:\n" + 
            nearest.name + "\n" +
            nearest.area + ", " + nearest.city + "\n" +
            "Distance: " + minD.toFixed(2) + " km"
          );
        }
      });
    }

    function distance(lat1, lon1, lat2, lon2){
      const R = 6371;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

  </script>
</body>
</html>
